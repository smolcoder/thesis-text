\chapter{Задача автоматического тегирования}
\label{chapter1}

В данной главе формулируется задача автотегирования, описываются основные этапы ее решения, 
начиная с извлечения характеристических признаков и заканчивая обзором алгоритмов машинного обучения.

\section{Постановка общей задачи}
Здесь и далее \emph{песней} будем называть цифровое представление акустических волн некоторой музыкальной компазиции (например, форматы \emph{mp3}, \emph{midi}, \emph{wav}).

Пусть имеется множество песен $S = \{s_1, s_2, \ldots, s_D \}$, а также словарь $ \mcV $, состоящий из $ \mcV $ уникальных слов. 
Каждое ``слово'' $w_i \in \mcV$ представляет из себя семантический тег, например ``рок'', ``грусть'', ``счастье'', ``фортепиано''.

Задачу автоматического тегирования можно условно представить в виде двух смежных задач: 
\begin{itemize}
 \item нахождение тегов, наиболее характерных (семантически значимых) для заданной непротегированной песни (\emph{annotation problem});
 \item поиск релевантных песен по заданному тегу (\emph{retrieval problem}).
\end{itemize}

Первая задача может рассматриваться как мультиклассовая классификация, где метками классов является множество $W$.
Во второй задаче проверяется, на сколько хорошо алгоритм автотегирования способен выбирать по заданному тегу наиболее подходящие песни.

Опишем задачи формально.
Рассмотрим вектор $\mb{y} = (y_1, \ldots, y_{| \mcV |})$, где $y_i > 0$ означает, что $w_i$ соотносится с песней, $y_i = 0$ в противном случае.
Назовем его \emph{вектором семантических весов}.

Задача сопоставления тегов непротегированной песне $s_q$ заключается в нахождении такого семантического вектора $\mb{y}$, 
что множество тегов $\mcW = \{w_i \mid w_i \in \mcV, y_i > 0\}$ наиболее точно характеризует песню $s_q$.

Задача поиска релевантных песен по тегу $w_q$ заключается в формировании упорядоченного множества $R = (s_{i_1}, \ldots, s_{i_D})$ такого, что:
\begin{itemize}
 \item $i_j \in \{1, \ldots, D \}$;
 \item обозначим семантический вектор $s_{i_a}$ за $y^a$, $s_{i_b}$ \ld за $y^b$, тогда $a > b \Rightarrow y^a_q >= y^b_q $.
\end{itemize}
В данной задаче величина $y^m_i$ семантического вектора интерпретируется как степень принадлежности тега $w_i$ песне $s_{i_m}$. 


TODO перенести в описание обучающей выборки.
Определим датасет $\mcD = \{ ({\mcX}_1, y_1), \ldots, ({\mcX}_D, y_D) \}$ \ld множество пар таких, 
что:
\begin{itemize}
 \item песня $s_i$ представляется как множество ${\mcX}_i = \{ \mb{x}_1, \ldots, \mb{x}_T\}$ из $T$ векторов,
 содержащих вещественные значения характеристических признаков небольшого ($\sim$ 23мс) отрыка песни;
 \item $T$ зависит от длины песни;
 \item $y_i$ \ld семантический вектор песни $s_i$.
\end{itemize}
 
\section{Просесс автоматического тегирования}

\subsection{Извлечение характеристических признаков}
\subsection{Выбор характеристических признаков}
\subsection{Сужение пространства характеристических признаков}
\subsection{Метрики расстояний}
\subsection{Обзор алгоритмов ближайших соседей}
\subsubsection{Взвешенный k-NN}
\subsubsection{CBDC}

\section{Выводы по главе \ref{chapter1}}
Запилить выводы по главе.





